<!DOCTYPE html>
<html>
<head>
    <title>Scroll-triggered Canvas Animation</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            height: 300%; /* Example height to allow for scrolling */
        }

        canvas {
            width: 100vw;
            height: 100vh;
            display: block; /* Remove default margin */
            position: fixed;
            top: 0;
            left: 0;
        }

        #prodCanvas, #additionalCanvas {
            display: none; /* Initially hidden */
        }

        #start-button {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            cursor: pointer;
        }
    </style>
</head>
<body>
    <canvas id="initialCanvas"></canvas>
    <canvas id="prodCanvas"></canvas>
    <canvas id="additionalCanvas"></canvas>
    <button id="start-button">Start Scroll Animation</button>

    <script>
    const totalFrames = 249; // Adjust according to your sequence
    const initialImages = [], prodImages = [], additionalImages = [];

    // Define paths for your image sequences
    const initialAnimationPath = '/Users/dz382/Documents/GitHub/Versuni/btl-tryouts/homepage-assets/home-entrance-desktop';
    const prodAnimationPath = '/Users/dz382/Documents/GitHub/Versuni/btl-tryouts/home-product-showcase-desktop/home-product-showcase-desktop';
    const additionalAnimationPath = '/Users/dz382/Documents/GitHub/Versuni/btl-tryouts/home-configurator/home-configurator-out';

    const initialCanvas = document.getElementById('initialCanvas').getContext('2d');
    const prodCanvas = document.getElementById('prodCanvas').getContext('2d');
    const additionalCanvas = document.getElementById('additionalCanvas').getContext('2d');

    let currentCanvas = initialCanvas;
    let scrollAnimationEnabled = false;
    let currentFrame = 0;

    // Function to preload images
    function preloadImages(paths, imageArray) {
        for (let i = 0; i < totalFrames; i++) {
            const img = new Image();
            img.src = `${paths}${i.toString().padStart(3, '0')}.jpg`;
            imageArray.push(img);
        }
    }

    // Preload images for each sequence
    preloadImages(initialAnimationPath, initialImages);
    preloadImages(prodAnimationPath, prodImages);
    preloadImages(additionalAnimationPath, additionalImages);

    function updateFrame(frameIndex) {
        currentCanvas.clearRect(0, 0, currentCanvas.canvas.width, currentCanvas.canvas.height);
        let img;
        if (currentCanvas === initialCanvas) {
            img = initialImages[frameIndex];
        } else if (currentCanvas === prodCanvas) {
            img = prodImages[frameIndex];
        } else if (currentCanvas === additionalCanvas) {
            img = additionalImages[frameIndex];
        }
        currentCanvas.drawImage(img, 0, 0, currentCanvas.canvas.width, currentCanvas.canvas.height);
    }

    function startInitialAnimation() {
        const initialAnimationInterval = setInterval(() => {
            if (currentFrame < initialImages.length) {
                updateFrame(currentFrame);
                currentFrame++;
            } else {
                clearInterval(initialAnimationInterval);
                scrollAnimationEnabled = true;
                currentCanvas = prodCanvas;
                document.getElementById('start-button').style.display = 'none';
            }
        }, 1000 / 30); // Adjust frame rate as needed
    }

    document.getElementById('start-button').addEventListener('click', startInitialAnimation);

    window.addEventListener('scroll', () => {
        if (!scrollAnimationEnabled) return;

        const scrollY = window.scrollY;
        let frameIndex = Math.floor(scrollY / 10) % totalFrames; // Example calculation

        if (scrollY < window.innerHeight) {
            currentCanvas = initialCanvas;
            prodCanvas.canvas.style.display = 'none';
            additionalCanvas.canvas.style.display = 'none';
        } else if (scrollY < 2 * window.innerHeight) {
            currentCanvas = prodCanvas;
            initialCanvas.canvas.style.display = 'none';
            prodCanvas.canvas.style.display = 'block';
            additionalCanvas.canvas.style.display = 'none';
        } else {
            currentCanvas = additionalCanvas;
            initialCanvas.canvas.style.display = 'none';
            prodCanvas.canvas.style.display = 'none';
            additionalCanvas.canvas.style.display = 'block';
        }

        updateFrame(frameIndex);
    });
    </script>
</body>
</html>
