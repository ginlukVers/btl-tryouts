<!DOCTYPE html>
<html>

<head>
    <title>Scroll-triggered Animation</title>
    <style>
    body,
    html {
        margin: 0;
        padding: 0;
        overflow-x: hidden;
    }

    #animation-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        overflow: hidden;
    }

    #frame {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    #start-button {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        display: none;
        /* Initially hidden */
        cursor: pointer;
    }
    </style>
</head>

<body>
    <div id="animation-container">
        <img id="frame" src="" alt="Animated Frame">
    </div>
    <button id="start-button">Start Scroll Animation</button>

    <script>
    const frameElement = document.getElementById('frame');
    const startButton = document.getElementById('start-button');
    const totalFrames = 249;
    const initialAnimationFrames = 28;
    let currentFrame = 0;
    let scrollAnimationEnabled = false;
    const frameRate = 1000 / 30; // 30 FPS

    function updateFrame(frameIndex) {
        frameElement.src = `/Users/dz382/Documents/GitHub/Versuni/btl-tryouts/homepage-assets/home-entrance-desktop${frameIndex.toString().padStart(3, '0')}.jpg`;
    }

    // Initial animation from frame 1 to 28
    const initialAnimationInterval = setInterval(() => {
        if (currentFrame < initialAnimationFrames) {
            updateFrame(currentFrame);
            currentFrame++;
        } else {
            clearInterval(initialAnimationInterval);
            currentFrame = initialAnimationFrames - 1;
            scrollAnimationEnabled = true;
            startButton.style.display = 'block'; // Show the button
        }
    }, frameRate);

    window.addEventListener('scroll', () => {
        if (!scrollAnimationEnabled) return;

        // Get the height of the animation container
        const animationContainerHeight = document.getElementById('animation-container').offsetHeight;

        // Calculate the scroll fraction based on the animation container height
        const scrollFraction = window.pageYOffset / animationContainerHeight;
        const frameIndex = Math.min(
            Math.floor(scrollFraction * totalFrames),
            totalFrames - 1
        );
        updateFrame(frameIndex);
    });

    startButton.addEventListener('click', function() {
        // Set the body height to be the same as the animation container height
        document.body.style.height = `${document.getElementById('animation-container').offsetHeight}px`;
        // No need for smooth scrolling function here, removed for simplicity
    });
    </script>
</body>
</html>